\subsection{Physiological signals in frequency- and time-domain}
\subsubsection{Respiratory rate}
\subsubsection{Sleep phase recognition}
The most reliable way to track sleep phases is by using an electroencephalography (EEG); that is measuring the electrical activity of the brain by placing electrodes on the scalp. Various different types of neural oscillations can be distinguished - the most important for sleep phase detection are alpha waves, theta waves, delta waves and sleep spindles. The American Academy of Sleep Medicine (AASM) distinguishes three different phases of non-rapid eye movement sleep (NREM) and REM phase [11]. 
\begin{itemize}
\item Stage 1 - occurs mostly in the beginning of sleep. It has slow eye movement, alpha waves disappear and the theta wave appears. 
\item Stage 2 - dreaming is very rare and no eye movement occurs. The sleeper is quite easily awakened. EEG recordings have a tendency for characteristic "sleep spindles"
\item Stage 3 - was previously divided into stages 3 and 4. It is slow-wave sleep (SWS) or deep sleep. Stage 3 used to be the transition between stages 2 and 4 where delta waves began to occur, while delta waves are dominant in stage 4. 
\item REM sleep - is a phase of sleep characterized by random and rapid movement of the eyes. It is considered the lightest phase of sleep and occurs all through the night but gets longer close to morning.
\end{itemize}

\begin{minipage}{\linewidth}
\centering
\includegraphics[width=0.6\textwidth]{images/proc_phys_sleepphase}
\captionof{figure}{Example of human sleep phases throughout the night}
\label{fig:proc_phys_sleepphase}
\end{minipage}

A typical distribution of sleep phases throughout the night is shown in Figure \ref{fig:proc_phys_sleepphase}. It can be easily seen that the sleep is distributed into different cycles, whereas the sleeping person is moving through the different sleep phases until having a REM phase and then going back to deep sleep. If the only available data is body movements it is becoming more difficult to reliably determine the sleep phase. Studies have shown that the magnitude of movement is typically associated to the follow-ing phases in decreasing order: wake, stage 1, REM, stage 2, stage 3 [12]. Another method is distinguishing between awake phase, active sleep and quite sleep and takes into account the order of those phases. This information allows to correlate the actual sleep phases with good certainty [13]. We have chosen this method for our system.

Capacitive proximity sensors enable us to detect the presence of suitable object and their relative proximity to the electrode. Consequently a moving object will cause a change of sensor values. If we aggregate these data deviations from an array of sensors we get a reliable measure of objects moving above the electrodes. In the case of MoviBed we can assume that there is a limited number of persons moving on top of the sensors and thus it is possible to associate the sensor values to movement. In the following we will present a suitable method to achieve a reliable detection of the movements of a sleeping person. We are following a similar approach as Salmi and Leinonen [13].
At any given time t a set of the latest values of all n sensors can be stored as a tuple in the following form: 
\begin{equation}
\overrightarrow{s_t}=\begin{pmatrix}
s_{1_t}\\ 
s_{2_t}\\ 
\vdots \\ 
s_{n_t}
\end{pmatrix}
\end{equation} 

%(s_t ) ⃗=(■(s_(1_t )@s_(2_t )@■(⋮@s_(n_t ) )))
As capacitive proximity sensors are particularly susceptible to external influences, such as temperature, humidity and other electric fields it is necessary to apply filtering on the sensor values. A suitable candidate is a median filter - a low-pass filter method that selects the median object of a sorted set of values, thus discarding outliers and strongly deviating values. This is particularly suited if transmission errors may occur.
If a person is moving on the bed the value of all sensors in detection distance of the moved body parts will change accordingly, the most relevant example in our case being a person moving in its sleep. We can generate a measure of movement intensity by comparing the values at time t with those at time t-1 resulting in:
\begin{equation}
\overrightarrow{d_t}=\left | \overrightarrow{s_t}-\overrightarrow{s_{t-1}} \right | = \begin{pmatrix}
\left | s_{1_t}-s_{1_{t-1}} \right |\\ 
\left | s_{2_t}-s_{2_{t-1}} \right |\\ 
\vdots \\ 
\left | s_{n_t}-s_{n_{t-1}} \right |
\end{pmatrix}
\end{equation}
%(d_t ) ⃗=|(s_t ) ⃗-(s_(t-1) ) ⃗ |=(■(|s_(1_t )-s_(1_(t-1) ) |@|s_(2_t )-s_(2_(t-1) ) |@■(⋮@|s_(n_t )-s_(n_(t-1) ) | )))
In subsequent calculations we will use $\overrightarrow{d_t}$ as combined measurement. For distinguishing between wake, active sleep and quiet sleep we are solely interest in the most intense movement. Thus we are testing for the largest value over a set of $m$ samples, generating the value $b_t$.
\begin{equation}
b_t=max(\overrightarrow{d_t1, d_t2, \hdots, d_tm}
\end{equation}
%b_t=max⁡((d_t1 ) ⃗,(d_t2 ) ⃗,…,(d_tm ) ⃗)
The value $b_t$ is affected by changes in the speed of movement. Therefor as a final step we generate a centered average value of order $2q-1$:
\begin{equation}
\overline{b_t}=\frac{1}{2q-1}\sum_{i=-1}^q{b_{t-i}}
\end{equation}
%(b_t ) ̅=1/(2q-1) ∑_(i=-q)^q▒b_(t-i) 
The resulting value $\overline{b_t}$ allows us to quantify the intensity of movements over a given period. In order to extract an actual body movement from this value we have to quantify a threshold $s(t)$ that is determined by the average of $q$ previous values of $\overline{b_t}$ multiplied with a factor $f$ that has to be evaluated individually for each configuration of bed and sensors. This threshold $s(t)$ allows us to identify a movement $m$ at any time $t$. This behavior is denoted in the following equations:
\begin{equation}
s(t)=\left ( \frac{1}{q}\sum_{i=1}^{q+1}{\overline{b_{t-1}}} \right )\cdot f
\end{equation}
\begin{equation}
m_t=\left\{\begin{matrix}
1,if \; \overline{b_t}> s(t)>\overline{b_{{t-1}}}\\ 
0,else
\end{matrix}\right.
\end{equation}

As previously mentioned it is difficult to determine sleep phases solely by monitoring the movement. Instead following the example of Salmi and Leinonen and distinguish three phases - wake, active sleep and quiet sleep [13]. These are determined by dividing the sleep time into $a$ three-minute epochs $e_{i_a}$ and qualify these as active or quiet by counting the number of movements occurring in those intervals and comparing it to the average amount of movements in all epochs $\overline{e_a}$ determined by the following equations:
\begin{align}
e_{i_a}&=\sum_{e_{i_Start}}^{e_{i_End}}{m_i} & \overline{e_a}&=\frac{1}{n}\sum_{i=0}^n{e_{i_a}}
\end{align}
%e_(i_a )=∑_(e_(i_Start ))^(e_(i_End ))▒m_i    ,    (e_a ) ̅=1/n ∑_(i=0)^n▒e_(i_a ) 

In consequence we determine the status of any epoch with this final equation:
\begin{equation}
e_{i_a}=\left\{\begin{matrix}
active,if \; e_{i_a}>\overline{e_a}\\ 
quiet,if \; e_{i_a}\leq \overline{e_a}
\end{matrix}\right.
\end{equation}
%e_(i_a )={█(active,if e_(i_a )>(e_a ) ̅  @quiet,ife_(i_a )≤(e_a ) ̅ )┤
These active and quiet periods can be semi-autonomously interpreted by humans in order to determine the actual sleep phases. For example initial activity for 20 to 40 minutes followed by a quiet period can be attributed to a person falling asleep. Following quiet phases are a good indicator for deep sleep phases.
 
